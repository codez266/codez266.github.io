<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Modeling indoor behaviors using deep-RL | Sumit Asthana </title> <meta name="author" content="Sumit Asthana"> <meta name="description" content="Modeling indoor behaviors of people using deep-RL and simulating virus transmissions to evaluate health interventions"> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="sumitasthana.xyz/projects/project_modeling_indoor_behaviors/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Sumit</span> Asthana </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/publications/">publications </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Modeling indoor behaviors using deep-RL</h1> <p class="post-description">Modeling indoor behaviors of people using deep-RL and simulating virus transmissions to evaluate health interventions</p> </header> <article> <blockquote> <p>ðŸ“˜ <strong>This post is an accessible read of a work being prepared for publication</strong></p> <p>I am happy to share the code on request for any evaluation of skills, or discussion about the project. After the submission of the work for review, I will open-source the code, and the manuscript on arxiv.</p> </blockquote> <h2 id="simulating-indoor-behavior-and-viral-transmission-with-deep-rl">Simulating Indoor Behavior and Viral Transmission with Deep RL</h2> <p>This project simulates human behavior in an indoor home environment using Deep Q-Learning to model rational decision-making based on physiological and routine-driven needs. Each agent (represented as a circle in the simulation) has internal state variables such as <code class="language-plaintext highlighter-rouge">needs_food</code>, <code class="language-plaintext highlighter-rouge">needs_bathroom</code>, and others that drive its movement across rooms (e.g., kitchen, bathroom, bedroom).</p> <p>The goal is to train agents to behave in a way that satisfies their needs efficiently while interacting with others in a shared spaceâ€”capturing both individual rationality and population-level emergent behavior.</p> <h3 id="a-video-demo">A video demo</h3> <p>Below is a short clip describing the simulation. One of the agents is infected with covid-19 and the other is uninfected. They move about, occassionally going to the bathroom or kitchen depending on the next.</p> <div class="row justify-content-sm-center"> <div class="col-sm-8 col-md-8 mt-3 mt-md-0"> <video width="100%" controls=""> <source src="/assets/video/behavior_modeling.mp4" type="video/mp4"></source> Your browser does not support the video tag. </video> </div> </div> <hr> <h3 id="feature-representation">Feature Representation</h3> <p>Each agentâ€™s state is encoded as a one-hot vector concatenating both <strong>need states</strong> and <strong>room location</strong>. Specifically:</p> <p>Let:</p> <ul> <li>\(\mathbf{n} \in \{0,1\}^N\) be a one-hot vector representing the current active need (e.g., hunger, bathroom).</li> <li>\(\mathbf{r} \in \{0,1\}^R\) be a one-hot vector representing the agentâ€™s current room (e.g., kitchen, bathroom, bedroom, etc.).</li> </ul> <p>The full input to the Q-network is:</p> \[\mathbf{s} = [\mathbf{n} | \mathbf{r}]\] <table> <tbody> <tr> <td>where $$</td> <td>$$ denotes concatenation.</td> </tr> </tbody> </table> <p>This vectorized state is passed through a neural network (Q-network) to produce Q-values for each possible room transition action.</p> <hr> <h3 id="learning">Learning</h3> <p>Agents are trained using the standard Deep Q-Learning algorithm. The objective is to approximate the optimal action-value function \(Q^*(s, a)\), which represents the expected cumulative reward from state \(s\), taking action \(a\), and following the optimal policy thereafter.</p> <p>At each step, we minimize the temporal difference loss:</p> \[\mathcal{L}(\theta) = \mathbb{E}_{(s, a, r, s')} \left[ \left( r + \gamma \max_{a'} Q_\theta^{-}(s', a') - Q_\theta(s, a) \right)^2 \right]\] <p>where:</p> <ul> <li>\(\theta\) are the parameters of the current Q-network.</li> <li>\(Q_\theta^{-}\) is a target network with periodically updated weights.</li> <li>\(\gamma \in [0,1]\) is the discount factor.</li> <li>\(r\) is the reward received for satisfying a need.</li> </ul> <p>Rewards are sparse and only provided when a need is satisfied (e.g., an agent eats when <code class="language-plaintext highlighter-rouge">needs_food</code> is active and they enter the kitchen).</p> <h3 id="virus-transmission-dynamics">Virus Transmission Dynamics</h3> <p>In addition to behavioral modeling, the simulation includes a probabilistic model of airborne virus transmission, visualized as red particles that diffuse through space.</p> <p>Each infected agent emits viral particles following a Gaussian spatial distribution centered at their current location:</p> \[P(x, y) = \frac{1}{2\pi\sigma^2} \exp\left(-\frac{(x - x_0)^2 + (y - y_0)^2}{2\sigma^2}\right)\] <p>where:</p> <ul> <li>\((x_0, y_0)\) is the agentâ€™s current position,</li> <li>\(\sigma\) is the spread parameter that increases with infection intensity,</li> <li>\(P(x, y)\) is the probability density of viral concentration at point \((x, y)\).</li> </ul> <p>The <strong>intensity of infection</strong> determines both the <strong>frequency</strong> of particle emission and the <strong>spread</strong> of the Gaussian. This intensity is a time-dependent function that peaks between 4â€“7 days post-infection and then decays:</p> \[I(t) = \exp\left(-\frac{(t - \mu)^2}{2\sigma_t^2} \right)\] <p>with:</p> <ul> <li>\(t\) as the number of days since contact,</li> <li>\(\mu = 5.5\) (days),</li> <li>\(\sigma_t = 1.0\).</li> </ul> <p>Transmission risk is computed by integrating exposure over time and proximity to infected individuals. When multiple agents are in the same room, this allows the simulation to capture how behavioral patternsâ€”like congregating in the kitchenâ€”can influence disease spread at both the individual and population levels.</p> <hr> <h3 id="applications">Applications</h3> <p>This system provides a testbed for studying:</p> <ul> <li>The effect of household layouts on transmission risk.</li> <li>The impact of behavioral interventions (e.g., staggered routines).</li> <li>Emergent coordination among rational agents in confined, shared spaces.</li> </ul> <p>By combining deep reinforcement learning with epidemiological modeling, this simulation allows for a rich analysis of decision-making under constraints, with applications in public health, smart environments, and human-AI interaction design.</p> <h3 id="next-steps">Next Steps</h3> <p>Future directions aim to enrich the simulationâ€™s realism and policy relevance by incorporating adaptive behavioral and environmental responses:</p> <ul> <li> <p><strong>Avoidance Behavior</strong>: Extend agent behavior policies to include infection-aware actions, such as avoiding rooms recently visited by infected individuals or dynamically rerouting to meet needs while minimizing risk. These behaviors can be trained via modified reward structures that penalize risky proximity.</p> </li> <li> <p><strong>Intervention Modeling</strong>: Simulate public health interventions such as room-based ventilation improvements, masking, scheduled access to shared spaces (e.g., staggered kitchen use), or isolation protocols. These can be encoded as either constraints on agent actions or environmental parameters influencing transmission probability.</p> </li> <li> <p><strong>Dynamic Policy Optimization</strong>: Implement meta-RL or multi-agent coordination mechanisms to explore how global objectives (e.g., minimizing overall infection) can be balanced against individual needs through learned policies.</p> </li> </ul> <p>These additions will allow the simulation to serve as a testbed for evaluating the effectiveness of behavioral and policy interventions in indoor spaces.</p> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> Â© Copyright 2025 Sumit Asthana. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>